(()=>{"use strict";var t={};function e(t){let e=0,o=!1;return{length:t,get hits(){return e},get isSunk(){return o},hit:function(){e++,e===t&&(o=!0)}}}function o(){const t=Array.from(Array(10),(()=>Array(10).fill().map((()=>({isHit:!1,ship:null}))))),e=[];return{board:t,placeShip:function(o,r,n,i){if(r<0||r>=10||n<0||n>=10)throw new Error("Invalid coordinates");if(i){if(n+o.length>10)throw new Error("Ship placement out of bounds");for(let e=0;e<o.length;e++)if(null!==t[n+e][r].ship)throw new Error("Ship placement overlap");for(let e=0;e<o.length;e++)t[n+e][r]={ship:o,isHit:!1}}else{if(r+o.length>10)throw new Error("Ship placement out of bounds");for(let e=0;e<o.length;e++)if(null!==t[n][r+e].ship)throw new Error("Ship placement overlap");for(let e=0;e<o.length;e++)t[n][r+e]={ship:o,isHit:!1}}e.push(o)},receiveAttack:function(e,o){if(e<0||e>=10||o<0||o>=10)throw new Error("Invalid coordinates");const r=t[o][e];return null!==r.ship&&0==r.isHit?(r.isHit=!0,r.ship.hit(),!0):!(!r||0!=r.isHit||(r.isHit=!0,0))},areAllShipsSunk:function(){return e.every((t=>t.isSunk))}}}t.d=(e,o)=>{for(var r in o)t.o(o,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:o[r]})},t.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),console.log("mazda".split("").reverse().join(""));const r=o(),n=o();function i(t){const o=[5,4,3,3,2];for(let r of o){let o=!1;for(;!o;)try{const n=Math.random()>=.5,i=Math.floor(9*Math.random()),l=Math.floor(9*Math.random());t.placeShip(e(r),i,l,n),o=!0}catch(t){console.error(t)}}}i(r),i(n);const l={attack(t,e,o){t.receiveAttack(e,o)}},a={attack(t){let e=!1;for(;!e;){const o=Math.floor(10*Math.random()),r=Math.floor(10*Math.random()),n=t.board[r][o];console.log(n),n&&!n.isHit&&(t.receiveAttack(o,r),e=!0)}}};let s=l;function c(){s=s===l?a:l}const h=document.getElementById("player-board"),d=document.getElementById("computer-board");function p(t,e){e.innerHTML="";for(let o=0;o<t.board.length;o++)for(let r=0;r<t.board[o].length;r++){const i=document.createElement("div");i.classList.add("square"),null===t.board[o][r].ship&&!0===t.board[o][r].isHit&&(console.log("yo"+t.board[o][r].ship),console.log("is hit"+t.board[o][r].isHit),i.classList.add("miss"),i.textContent="miss"),null!==t.board[o][r].ship&&(!0===t.board[o][r].isHit?(i.classList.add("hit"),i.textContent="hit"):(i.classList.add("ship"),i.textContent="ship")),i.addEventListener("click",(()=>{s!==l||t.board[o][r].isHit||(s.attack(n,r,o),p(n,d),c(),u())})),e.appendChild(i)}}function u(){r.areAllShipsSunk()?alert("Computer wins!"):n.areAllShipsSunk()?alert("Player wins!"):s===a&&(console.log(r.board),s.attack(r),p(r,h),c(),u())}p(r,h),p(n,d),u()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL2JhdHRsZXNoaXAvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiZnVuY3Rpb24gcmV2ZXJzZVN0cmluZyhzdHIpIHtcbiAgcmV0dXJuIHN0ci5zcGxpdChcIlwiKS5yZXZlcnNlKCkuam9pbihcIlwiKTtcbn1cblxuY29uc29sZS5sb2cocmV2ZXJzZVN0cmluZyhcIm1hemRhXCIpKTtcblxuLy9TSElQIEZBQ1RPUllcblxuZnVuY3Rpb24gc2hpcChsZW5ndGgpIHtcbiAgbGV0IF9oaXRzID0gMDtcbiAgbGV0IGlzU3VuayA9IGZhbHNlO1xuXG4gIGZ1bmN0aW9uIGhpdCgpIHtcbiAgICBfaGl0cysrO1xuICAgIGlmIChfaGl0cyA9PT0gbGVuZ3RoKSB7XG4gICAgICBpc1N1bmsgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgbGVuZ3RoLFxuICAgIGdldCBoaXRzKCkge1xuICAgICAgcmV0dXJuIF9oaXRzO1xuICAgIH0sXG4gICAgZ2V0IGlzU3VuaygpIHtcbiAgICAgIHJldHVybiBpc1N1bms7XG4gICAgfSxcbiAgICBoaXQsXG4gIH07XG59XG5cbi8vR0FNRUJPQVJEIEZBQ1RPUllcblxuZnVuY3Rpb24gZ2FtZWJvYXJkKCkge1xuICBjb25zdCBib2FyZCA9IEFycmF5LmZyb20oQXJyYXkoMTApLCAoKSA9PlxuICAgIEFycmF5KDEwKVxuICAgICAgLmZpbGwoKVxuICAgICAgLm1hcCgoKSA9PiAoe1xuICAgICAgICBpc0hpdDogZmFsc2UsXG4gICAgICAgIHNoaXA6IG51bGwsXG4gICAgICB9KSlcbiAgKTtcblxuICBjb25zdCBzaGlwcyA9IFtdO1xuXG4gIGZ1bmN0aW9uIHBsYWNlU2hpcChzaGlwLCB4LCB5LCBpc1ZlcnRpY2FsKSB7XG4gICAgaWYgKHggPCAwIHx8IHggPj0gMTAgfHwgeSA8IDAgfHwgeSA+PSAxMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBjb29yZGluYXRlc1wiKTtcbiAgICB9XG5cbiAgICBpZiAoaXNWZXJ0aWNhbCkge1xuICAgICAgaWYgKHkgKyBzaGlwLmxlbmd0aCA+IDEwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlNoaXAgcGxhY2VtZW50IG91dCBvZiBib3VuZHNcIik7XG4gICAgICB9XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoYm9hcmRbeSArIGldW3hdLnNoaXAgIT09IG51bGwpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTaGlwIHBsYWNlbWVudCBvdmVybGFwXCIpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5sZW5ndGg7IGkrKykge1xuICAgICAgICBib2FyZFt5ICsgaV1beF0gPSB7IHNoaXA6IHNoaXAsIGlzSGl0OiBmYWxzZSB9O1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoeCArIHNoaXAubGVuZ3RoID4gMTApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2hpcCBwbGFjZW1lbnQgb3V0IG9mIGJvdW5kc1wiKTtcbiAgICAgIH1cblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChib2FyZFt5XVt4ICsgaV0uc2hpcCAhPT0gbnVsbCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlNoaXAgcGxhY2VtZW50IG92ZXJsYXBcIik7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGJvYXJkW3ldW3ggKyBpXSA9IHsgc2hpcDogc2hpcCwgaXNIaXQ6IGZhbHNlIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgc2hpcHMucHVzaChzaGlwKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlY2VpdmVBdHRhY2soeCwgeSkge1xuICAgIGlmICh4IDwgMCB8fCB4ID49IDEwIHx8IHkgPCAwIHx8IHkgPj0gMTApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgY29vcmRpbmF0ZXNcIik7XG4gICAgfVxuXG4gICAgY29uc3Qgc3F1YXJlID0gYm9hcmRbeV1beF07XG4gICAgaWYgKHNxdWFyZS5zaGlwICE9PSBudWxsICYmIHNxdWFyZS5pc0hpdCA9PSBmYWxzZSkge1xuICAgICAgc3F1YXJlLmlzSGl0ID0gdHJ1ZTtcbiAgICAgIHNxdWFyZS5zaGlwLmhpdCgpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIGlmIChzcXVhcmUgJiYgc3F1YXJlLmlzSGl0ID09IGZhbHNlKSB7XG4gICAgICBzcXVhcmUuaXNIaXQgPSB0cnVlO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBhcmVBbGxTaGlwc1N1bmsoKSB7XG4gICAgcmV0dXJuIHNoaXBzLmV2ZXJ5KChzaGlwKSA9PiBzaGlwLmlzU3Vuayk7XG4gIH1cblxuICByZXR1cm4geyBib2FyZCwgcGxhY2VTaGlwLCByZWNlaXZlQXR0YWNrLCBhcmVBbGxTaGlwc1N1bmsgfTtcbn1cblxuZXhwb3J0IHsgcmV2ZXJzZVN0cmluZywgc2hpcCwgZ2FtZWJvYXJkIH07XG5cbi8vTUFJTiBHQU1FIExPT1BcblxuY29uc3QgcGxheWVyQm9hcmQgPSBnYW1lYm9hcmQoKTtcbmNvbnN0IGNvbXB1dGVyQm9hcmQgPSBnYW1lYm9hcmQoKTtcblxuZnVuY3Rpb24gcGxhY2VSYW5kb21TaGlwcyhib2FyZCkge1xuICBjb25zdCBzaGlwTGVuZ3RocyA9IFs1LCA0LCAzLCAzLCAyXTtcblxuICBmb3IgKGxldCBsZW5ndGggb2Ygc2hpcExlbmd0aHMpIHtcbiAgICBsZXQgc2hpcFBsYWNlZCA9IGZhbHNlO1xuXG4gICAgd2hpbGUgKCFzaGlwUGxhY2VkKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBpc0hvcml6b250YWwgPSBNYXRoLnJhbmRvbSgpID49IDAuNTtcbiAgICAgICAgY29uc3Qgcm93ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOSk7XG4gICAgICAgIGNvbnN0IGNvbCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDkpO1xuXG4gICAgICAgIGJvYXJkLnBsYWNlU2hpcChzaGlwKGxlbmd0aCksIHJvdywgY29sLCBpc0hvcml6b250YWwpO1xuICAgICAgICBzaGlwUGxhY2VkID0gdHJ1ZTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5wbGFjZVJhbmRvbVNoaXBzKHBsYXllckJvYXJkKTtcbnBsYWNlUmFuZG9tU2hpcHMoY29tcHV0ZXJCb2FyZCk7XG5cbmNvbnN0IHBsYXllciA9IHtcbiAgYXR0YWNrKGdhbWVib2FyZCwgeCwgeSkge1xuICAgIGdhbWVib2FyZC5yZWNlaXZlQXR0YWNrKHgsIHkpO1xuICB9LFxufTtcblxuY29uc3QgY29tcHV0ZXIgPSB7XG4gIGF0dGFjayhnYW1lYm9hcmQpIHtcbiAgICBsZXQgYXR0YWNrQ29tcGxldGVkID0gZmFsc2U7XG4gICAgd2hpbGUgKCFhdHRhY2tDb21wbGV0ZWQpIHtcbiAgICAgIGNvbnN0IHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICBjb25zdCB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgY29uc3Qgc3F1YXJlID0gZ2FtZWJvYXJkLmJvYXJkW3ldW3hdO1xuICAgICAgY29uc29sZS5sb2coc3F1YXJlKTtcbiAgICAgIGlmIChzcXVhcmUgJiYgIXNxdWFyZS5pc0hpdCkge1xuICAgICAgICBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayh4LCB5KTtcbiAgICAgICAgYXR0YWNrQ29tcGxldGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG59O1xuXG5sZXQgY3VycmVudFBsYXllciA9IHBsYXllcjtcblxuZnVuY3Rpb24gc3dpdGNoVHVybnMoKSB7XG4gIGlmIChjdXJyZW50UGxheWVyID09PSBwbGF5ZXIpIHtcbiAgICBjdXJyZW50UGxheWVyID0gY29tcHV0ZXI7XG4gIH0gZWxzZSB7XG4gICAgY3VycmVudFBsYXllciA9IHBsYXllcjtcbiAgfVxufVxuXG5jb25zdCBwbGF5ZXJCb2FyZEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllci1ib2FyZFwiKTtcbmNvbnN0IGNvbXB1dGVyQm9hcmRFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21wdXRlci1ib2FyZFwiKTtcblxuZnVuY3Rpb24gcmVuZGVyQm9hcmQoYm9hcmQsIGVsZW1lbnQpIHtcbiAgLy8gQ2xlYXIgdGhlIGJvYXJkIGJlZm9yZSByZW5kZXJpbmdcbiAgZWxlbWVudC5pbm5lckhUTUwgPSBcIlwiO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQuYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJvYXJkLmJvYXJkW2ldLmxlbmd0aDsgaisrKSB7XG4gICAgICBjb25zdCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJzcXVhcmVcIik7XG5cbiAgICAgIGlmIChib2FyZC5ib2FyZFtpXVtqXS5zaGlwID09PSBudWxsICYmIGJvYXJkLmJvYXJkW2ldW2pdLmlzSGl0ID09PSB0cnVlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwieW9cIiArIGJvYXJkLmJvYXJkW2ldW2pdLnNoaXApO1xuICAgICAgICBjb25zb2xlLmxvZyhcImlzIGhpdFwiICsgYm9hcmQuYm9hcmRbaV1bal0uaXNIaXQpO1xuICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcIm1pc3NcIik7XG4gICAgICAgIHNxdWFyZS50ZXh0Q29udGVudCA9IFwibWlzc1wiO1xuICAgICAgfVxuICAgICAgaWYgKGJvYXJkLmJvYXJkW2ldW2pdLnNoaXAgIT09IG51bGwpIHtcbiAgICAgICAgaWYgKGJvYXJkLmJvYXJkW2ldW2pdLmlzSGl0ID09PSB0cnVlKSB7XG4gICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJoaXRcIik7XG4gICAgICAgICAgc3F1YXJlLnRleHRDb250ZW50ID0gXCJoaXRcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcInNoaXBcIik7XG4gICAgICAgICAgc3F1YXJlLnRleHRDb250ZW50ID0gXCJzaGlwXCI7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgc3F1YXJlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIGlmIChjdXJyZW50UGxheWVyID09PSBwbGF5ZXIgJiYgIWJvYXJkLmJvYXJkW2ldW2pdLmlzSGl0KSB7XG4gICAgICAgICAgY3VycmVudFBsYXllci5hdHRhY2soY29tcHV0ZXJCb2FyZCwgaiwgaSk7XG4gICAgICAgICAgcmVuZGVyQm9hcmQoY29tcHV0ZXJCb2FyZCwgY29tcHV0ZXJCb2FyZEVsZW1lbnQpO1xuICAgICAgICAgIHN3aXRjaFR1cm5zKCk7XG4gICAgICAgICAgcGxheUdhbWUoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBlbGVtZW50LmFwcGVuZENoaWxkKHNxdWFyZSk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHBsYXlHYW1lKCkge1xuICBpZiAocGxheWVyQm9hcmQuYXJlQWxsU2hpcHNTdW5rKCkpIHtcbiAgICBhbGVydChcIkNvbXB1dGVyIHdpbnMhXCIpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChjb21wdXRlckJvYXJkLmFyZUFsbFNoaXBzU3VuaygpKSB7XG4gICAgYWxlcnQoXCJQbGF5ZXIgd2lucyFcIik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGN1cnJlbnRQbGF5ZXIgPT09IGNvbXB1dGVyKSB7XG4gICAgY29uc29sZS5sb2cocGxheWVyQm9hcmQuYm9hcmQpO1xuICAgIGN1cnJlbnRQbGF5ZXIuYXR0YWNrKHBsYXllckJvYXJkKTtcbiAgICByZW5kZXJCb2FyZChwbGF5ZXJCb2FyZCwgcGxheWVyQm9hcmRFbGVtZW50KTtcbiAgICBzd2l0Y2hUdXJucygpO1xuICAgIHBsYXlHYW1lKCk7XG4gIH1cbn1cblxucmVuZGVyQm9hcmQocGxheWVyQm9hcmQsIHBsYXllckJvYXJkRWxlbWVudCk7XG5yZW5kZXJCb2FyZChjb21wdXRlckJvYXJkLCBjb21wdXRlckJvYXJkRWxlbWVudCk7XG5wbGF5R2FtZSgpO1xuXG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNoaXAiLCJsZW5ndGgiLCJfaGl0cyIsImlzU3VuayIsImhpdHMiLCJoaXQiLCJnYW1lYm9hcmQiLCJib2FyZCIsIkFycmF5IiwiZnJvbSIsImZpbGwiLCJtYXAiLCJpc0hpdCIsInNoaXBzIiwicGxhY2VTaGlwIiwieCIsInkiLCJpc1ZlcnRpY2FsIiwiRXJyb3IiLCJpIiwicHVzaCIsInJlY2VpdmVBdHRhY2siLCJzcXVhcmUiLCJhcmVBbGxTaGlwc1N1bmsiLCJldmVyeSIsImQiLCJleHBvcnRzIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiY29uc29sZSIsImxvZyIsInNwbGl0IiwicmV2ZXJzZSIsImpvaW4iLCJwbGF5ZXJCb2FyZCIsImNvbXB1dGVyQm9hcmQiLCJwbGFjZVJhbmRvbVNoaXBzIiwic2hpcExlbmd0aHMiLCJzaGlwUGxhY2VkIiwiaXNIb3Jpem9udGFsIiwiTWF0aCIsInJhbmRvbSIsInJvdyIsImZsb29yIiwiY29sIiwiZXJyb3IiLCJwbGF5ZXIiLCJhdHRhY2siLCJjb21wdXRlciIsImF0dGFja0NvbXBsZXRlZCIsImN1cnJlbnRQbGF5ZXIiLCJzd2l0Y2hUdXJucyIsInBsYXllckJvYXJkRWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjb21wdXRlckJvYXJkRWxlbWVudCIsInJlbmRlckJvYXJkIiwiZWxlbWVudCIsImlubmVySFRNTCIsImoiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJhZGRFdmVudExpc3RlbmVyIiwicGxheUdhbWUiLCJhcHBlbmRDaGlsZCIsImFsZXJ0Il0sInNvdXJjZVJvb3QiOiIifQ==